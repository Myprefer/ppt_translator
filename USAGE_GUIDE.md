# PPT翻译软件使用说明

## 功能概述

本PPT翻译软件基于AI技术，可以智能翻译PowerPoint文档，同时保持原有格式，并提供以下主要功能：

### 1. 实时翻译进度显示
- 显示当前翻译到第几页
- 显示总页数和完成百分比
- 实时状态更新（提取文本 → 翻译中 → 重构PPT → 保存文件）

### 2. 本地文件自动保存
- 翻译完成后自动保存到本地 `translated_files` 目录
- 文件名格式：`translated_YYYYMMDD_HHMMSS_原始文件名.pptx`
- 支持查看本地保存的所有翻译文件
- 可以重新下载或删除本地文件

## 使用方法

### 基本翻译流程
1. 上传 `.pptx` 格式的PPT文件
2. 选择源语言和目标语言
3. 输入Qwen API密钥
4. 点击"开始翻译"
5. 实时查看翻译进度
6. 翻译完成后自动保存到本地，同时可以下载

### 本地文件管理
1. 翻译完成后，点击"查看本地文件"按钮
2. 查看所有本地保存的翻译文件
3. 可以重新下载任何历史翻译文件
4. 可以删除不需要的文件来节省空间

### 进度显示说明
- **进度条**：显示整体翻译进度百分比
- **页面信息**：显示"第 X 页 / 共 Y 页"
- **状态文本**：显示当前操作状态
  - "正在提取PPT文本..."
  - "发现 X 页幻灯片，开始翻译..."
  - "正在翻译第 X/Y 页..."
  - "正在重构PPT文件..."
  - "正在保存到本地..."
  - "翻译完成！文件已保存到本地"

## 文件存储位置

- **临时文件**：用于下载的临时文件存储在系统临时目录，会自动清理
- **本地存储**：翻译完成的文件永久保存在项目根目录的 `translated_files` 文件夹中

## 注意事项

1. 支持的文件格式：仅支持 `.pptx` 格式
2. 文件大小限制：最大 50MB
3. API密钥：需要有效的Qwen API密钥
4. 网络连接：翻译过程需要稳定的网络连接
5. 本地存储：请定期清理不需要的本地文件以节省磁盘空间

## 技术特性

- **异步处理**：翻译任务在后台执行，不阻塞界面
- **实时进度**：使用Server-Sent Events (SSE) 技术实现实时进度更新
- **双重保存**：临时文件用于下载，本地文件用于长期存储
- **安全性**：文件名安全处理，防止路径遍历攻击

## 启动应用

```bash
cd src
python main.py
```

应用将在 `http://localhost:5001` 启动。
